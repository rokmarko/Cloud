{% extends "base.html" %}

{% block content %}
<div class="page-header">
    <h1><span class="material-icons">flight_takeoff</span> {{ airfield.icao_code }} - {{ airfield.name }}</h1>
    <div>
        <a href="{{ url_for('admin.edit_airfield', airfield_id=airfield.id) }}" class="btn btn-primary me-2">
            <span class="material-icons me-2">edit</span> Edit
        </a>
        <a href="{{ url_for('admin.airfields') }}" class="btn btn-outline-secondary">
            <span class="material-icons me-2">arrow_back</span> Back to List
        </a>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Airfield Information</h5>
            </div>
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-sm-3">
                        <strong>ICAO Code:</strong>
                    </div>
                    <div class="col-sm-9">
                        <span class="badge bg-primary fs-6">{{ airfield.icao_code }}</span>
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-sm-3">
                        <strong>Name:</strong>
                    </div>
                    <div class="col-sm-9">
                        {{ airfield.name }}
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-sm-3">
                        <strong>Coordinates:</strong>
                    </div>
                    <div class="col-sm-9">
                        <code>{{ "%.6f"|format(airfield.latitude) }}, {{ "%.6f"|format(airfield.longitude) }}</code>
                        <br><small class="text-muted">Decimal degrees (WGS84)</small>
                    </div>
                </div>
                
                {% if airfield.country %}
                <div class="row mb-3">
                    <div class="col-sm-3">
                        <strong>Country:</strong>
                    </div>
                    <div class="col-sm-9">
                        <span class="badge bg-info">{{ airfield.country }}</span>
                    </div>
                </div>
                {% endif %}
                
                {% if airfield.region %}
                <div class="row mb-3">
                    <div class="col-sm-3">
                        <strong>Region:</strong>
                    </div>
                    <div class="col-sm-9">
                        {{ airfield.region }}
                    </div>
                </div>
                {% endif %}
                
                {% if airfield.elevation_ft %}
                <div class="row mb-3">
                    <div class="col-sm-3">
                        <strong>Elevation:</strong>
                    </div>
                    <div class="col-sm-9">
                        {{ airfield.elevation_ft }} ft
                        <small class="text-muted">({{ "%.0f"|format(airfield.elevation_ft * 0.3048) }} m)</small>
                    </div>
                </div>
                {% endif %}
                
                {% if airfield.source %}
                <div class="row mb-3">
                    <div class="col-sm-3">
                        <strong>Source:</strong>
                    </div>
                    <div class="col-sm-9">
                        <span class="badge bg-secondary">{{ airfield.source }}</span>
                    </div>
                </div>
                {% endif %}
                
                <div class="row mb-3">
                    <div class="col-sm-3">
                        <strong>Status:</strong>
                    </div>
                    <div class="col-sm-9">
                        {% if airfield.is_active %}
                            <span class="badge bg-success">Active</span>
                        {% else %}
                            <span class="badge bg-danger">Inactive</span>
                        {% endif %}
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-sm-3">
                        <strong>Created:</strong>
                    </div>
                    <div class="col-sm-9">
                        {{ airfield.created_at.strftime(current_user.date_format + " %H:%M UTC") }}
                    </div>
                </div>
                
                {% if airfield.updated_at != airfield.created_at %}
                <div class="row mb-3">
                    <div class="col-sm-3">
                        <strong>Last Updated:</strong>
                    </div>
                    <div class="col-sm-9">
                        {{ airfield.updated_at.strftime(current_user.date_format + " %H:%M UTC") }}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
        
        {% if airfield.runway_info or airfield.frequencies %}
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">Additional Information</h5>
            </div>
            <div class="card-body">
                {% if airfield.runway_info %}
                <div class="mb-3">
                    <strong>Runway Information:</strong>
                    <pre class="mt-2 bg-light p-2 rounded"><code>{{ airfield.runway_info }}</code></pre>
                </div>
                {% endif %}
                
                {% if airfield.frequencies %}
                <div class="mb-3">
                    <strong>Radio Frequencies:</strong>
                    <pre class="mt-2 bg-light p-2 rounded"><code>{{ airfield.frequencies }}</code></pre>
                </div>
                {% endif %}
            </div>
        </div>
        {% endif %}
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Map Location</h5>
            </div>
            <div class="card-body">
                <div id="map" style="height: 300px; background-color: #f8f9fa; display: flex; align-items: center; justify-content: center; border: 1px solid #dee2e6; border-radius: 0.375rem;">
                    <div class="text-center">
                        <span class="material-icons" style="font-size: 3rem; color: #6c757d;">location_on</span>
                        <p class="text-muted mt-2">{{ "%.4f"|format(airfield.latitude) }}, {{ "%.4f"|format(airfield.longitude) }}</p>
                        <small class="text-muted">Map integration coming soon</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">Actions</h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a href="{{ url_for('admin.edit_airfield', airfield_id=airfield.id) }}" class="btn btn-primary">
                        <span class="material-icons me-2">edit</span> Edit Airfield
                    </a>
                    
                    <form method="POST" action="{{ url_for('admin.delete_airfield', airfield_id=airfield.id) }}" class="mb-0">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        <button type="submit" class="btn btn-danger w-100" onclick="return confirm('Are you sure you want to delete {{ airfield.icao_code }} - {{ airfield.name }}?\n\nThis action cannot be undone.')">
                            <span class="material-icons me-2">delete</span> Delete Airfield
                        </button>
                    </form>
                </div>
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">Quick Links</h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a href="https://www.google.com/maps?q={{ airfield.latitude }},{{ airfield.longitude }}" target="_blank" class="btn btn-outline-primary">
                        <span class="material-icons me-2">map</span> Google Maps
                    </a>
                    <a href="https://skyvector.com/?ll={{ airfield.latitude }},{{ airfield.longitude }}&chart=301&zoom=4" target="_blank" class="btn btn-outline-primary">
                        <span class="material-icons me-2">flight</span> SkyVector
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid #e9ecef;
}

.page-header h1 {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0;
    color: #333;
}

pre code {
    background: none !important;
    padding: 0 !important;
}
</style>

{% endblock %}
